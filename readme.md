# Hashed Potatoes

## Abstract

対象Webサイトに対して更新検知をするユーティリティ。

- 監視サーバ(開発環境側): 対象サーバに設置した PHP プログラムへ HTTPリクエスト を投げて、返却されたレソポンスのハッシュ値と、手元の原本ファイルから計算したハッシュ値を比較して一致・不一致を判定する

## Usage

### 監視サーバ側

1. `local/src/config.php.sample` から `local/src/config.php` を作成し、必要に応じて設定を変更する
    - 対象サーバにセキュリティ機能が存在する場合、DoS攻撃と見なされないように注意。大規模サイトやファイル数が多い場合は特に要注意。
        - `pollingInterval`: `pollingEach` の件数ごとに休む時間(秒指定)。デフォルト `5`(秒)。
        - `pollingEach`: 休む頻度。デフォルト `10`(件)ごとに1回 `pollingInterval` で指定した秒数休む。
2. `composer require`
3. `local/origin/` に監視対象サイトの原本ファイルを配置する
    - ※文字コード、改行コードや制御文字等の表面上気付きづらい差に注意。ある時点でのサーバ上のデータをFTPでダウンロードして使用するならばバイナリモードでのダウンロードが良い。
4. `local/` 以下のファイル・ディレクトリを監視をさせるサーバにアップロード
5. サーバ上の `logs/` ディレクトリの権限を `777` にする
6. cron や手動で `local/hashpotatoes.php` にアクセスするようにする
